window.zs=window.zs||{},window.zs.laya=window.zs.laya||{},function(e,s){"use strict";class t extends s.Script{constructor(){super()}static initCFG(e){this.platformCfg=e,zs.laya.game.UIService.viewScript.knockEggAd=I,zs.laya.game.UIService.viewScript.floatAd=y,zs.laya.game.UIService.viewScript.listAd=v,zs.laya.game.UIService.viewScript.screenAd=z,zs.laya.game.PlatformInterface.Instance.enterGamePopup=t.enterGamePopup,zs.laya.game.PlatformInterface.Instance.onGameFaildPopUp=t.onGameFaildPopUp,zs.laya.game.PlatformInterface.Instance.onGameWinPopUp=t.onGameWinPopUp,zs.laya.game.PlatformInterface.Instance.onGameOverPopUp=t.onGameOverPopUp,zs.laya.game.PlatformInterface.Instance.showInsertAd=t.showInsertAd,zs.laya.game.PlatformInterface.Instance.onExportJumpCancel=t.onExportJumpCancel}static initGameAd(){zs.laya.sdk.SdkService.initVideoAd(a.zs_video_adunit),zs.laya.sdk.SdkService.initInsertAd(a.zs_full_screen_adunit,null)}static enterGamePopup(){a.zs_jump_switch&&a.isPublicVersion()&&s.timer.once(1500,this,()=>{null!=zs.laya.game.AppMain.playerInfo.is_new&&0==zs.laya.game.AppMain.playerInfo.is_new?zs.laya.game.UIService.showHomeFloatAd():null==zs.laya.game.AppMain.playerInfo.is_new&&zs.laya.game.UIService.showHomeFloatAd()})}static onGameFaildPopUp(){a.zs_history_list_jump?zs.laya.game.UIService.showListAd():a.zs_full_screen_jump&&zs.laya.game.UIService.showScreenAd()}static onGameWinPopUp(){a.zs_history_list_jump?zs.laya.game.UIService.showListAd():a.zs_full_screen_jump?zs.laya.game.UIService.showScreenAd():this.onFullToWin(data)}static onGameOverPopUp(){zs.laya.game.UIService.showScreenAd(),t.showInsertAd()}static showInsertAd(){if(a.zs_full_screen_ad_enable){var e=s.LocalStorage.getItem("zs_full_screen_ad_time_stamp");if(null==e||""==e||0==zs.laya.MiscUtils.isToday(Number(e))){var t=this;zs.laya.sdk.SdkService.loadInsertAd(s.Handler.create(null,function(){t.gameState==GameState.STATE_UNBEGIN&&(zs.laya.sdk.SdkService.showInsertAd(null),s.LocalStorage.setItem("zs_full_screen_ad_time_stamp",Date.now().toString()))}),null)}}}static onExportJumpCancel(){a.zs_jump_switch&&a.isPublicVersion()&&a.zs_full_screen_jump&&zs.laya.game.UIService.showScreenAd()}}t.platformCfg=null,s.ILaya.regClass(t),s.ClassUtils.regClass("zs.laya.platform.PlatformMgr",t),s.ClassUtils.regClass("Zhise.PlatformMgr",t);class a{constructor(){}static initAdSetting(e){this.response=e;var t=e.zs_banner_system?String(e.zs_banner_system).toUpperCase():null;this.zs_version=e.zs_number?e.zs_number:"0.0";var a=!t||!s.Browser.onMobile||!(-1!=t.indexOf("ANDROID")&&s.Browser.onAndroid||-1!=t.indexOf("IOS")&&!s.Browser.onAndroid);this.zs_switch=1==e.zs_switch&&a&&this.isPublicVersion(),this.egg_switch=1==e.zs_switch&&this.isPublicVersion(),this.zs_video_adunit=e.zs_video_adunit,this.zs_banner_adunit=e.zs_banner_adunit,this.zs_full_screen_adunit=e.zs_full_screen_adunit,this.zs_full_screen_ad_enable=1==e.zs_full_screen_ad,this.zs_banner_text_time=e.zs_banner_text_time?Number(e.zs_banner_text_time):1e3,this.zs_banner_banner_time=e.zs_banner_banner_time?Number(e.zs_banner_banner_time):1e3,this.zs_banner_refresh_time=e.zs_banner_refresh_time?Number(e.zs_banner_refresh_time):1e3,this.zs_banner_move_time=e.zs_banner_move_time?Number(e.zs_banner_move_time):1e3,this.zs_unmiss_text_time=e.zs_unmiss_text_time?Number(e.zs_unmiss_text_time):2e3,this.zs_banner_vertical_enable=1==e.zs_banner_vertical_enable,this.zs_banner_horizontal_enable=1==e.zs_banner_horizontal_enable,this.zs_share_title=e.zs_share_title,this.zs_share_image=e.zs_share_img,this.zs_shield_gdt_export=1==e.zs_shield_gdt_export,this.zs_jump_switch=1==e.zs_jump_switch&&(0==zs.laya.zsapp.zsAppSdk.Instance.isFromLink()||this.zs_shield_gdt_export),this.zs_revive_type=e.zs_revive_type,this.zs_revive_click_num=e.zs_revive_click_num,this.zs_revive_video_num=e.zs_revive_video_num,this.zs_revive_share_num=e.zs_revive_share_num,this.zs_full_screen_jump=1==e.zs_full_screen_jump,this.zs_history_list_jump=1==e.zs_history_list_jump,this.zs_finish_jump=1==e.zs_finish_jump,this.repair_click_num=this.zs_click_award_percent=e.zs_click_award_percent||[.3,.7],this.zs_click_award_back=e.zs_click_award_back?Number(e.zs_click_award_back):.00423,this.zs_click_award_num=zs.laya.MiscUtils.IsNumber(e.zs_click_award_num)?e.zs_click_award_num:e.zs_click_award_num||0,this.zs_click_award_add=e.zs_click_award_add||.1,this.zs_revive_countdown=e.zs_revive_countdown?Number(e.zs_revive_countdown):10,this.zs_jump_style=e.zs_jump_style?Number(e.zs_jump_style):0,this.zs_banner_rotate_id1=e.zs_banner_rotate_id1,this.zs_banner_rotate_id2=e.zs_banner_rotate_id2,this.zs_banner_rotate_id3=e.zs_banner_rotate_id3,this.zs_click_award_system=e.zs_click_award_system,this.zs_banner_show_number=this.getNumberVal(e.zs_banner_show_number,2),this.zs_full_screen_rotate=1==this.getNumberVal(e.zs_full_screen_rotate,0),this.zs_unmiss_text_time=this.getNumberVal(e.zs_unmiss_text_time,0),this.initOpenAwardNum()}static getNumberVal(e,s){return s=zs.laya.MiscUtils.IsNumber(s)?Number(s):0,zs.laya.MiscUtils.IsNumber(e)?Number(e):s}static initOpenAwardNum(){this.open_award_num=s.LocalStorage.getItem("open_award_num")||0,this.openEggTimes=0;var e=s.LocalStorage.getItem("open_award_num_time_stamp");null!=e&&""!=e&&0!=zs.laya.MiscUtils.isToday(Number(e))&&(s.LocalStorage.setItem("open_award_num_time_stamp",Date.now().toString()),s.LocalStorage.setItem("open_award_num",this.open_award_num=0))}static isPublicVersion(){return zs.laya.game.AppMain.appConfig.version!=this.zs_version}static isOpenEgg(e){if(!this.egg_switch)return!1;if(this.openEggTimes&&this.openEggTimes>0)return!1;if(this.zs_click_award_system){var t=this.zs_click_award_system.trim().toLowerCase();if("android"==t&&s.Browser.onAndroid)return!1;if("ios"==t&&s.Browser.onIOS)return!1}if(zs.laya.MiscUtils.IsNumber(this.zs_click_award_num)){if(-1==this.zs_click_award_num)return!0;var a=s.LocalStorage.getItem("open_award_num")||0;if(Number(this.zs_click_award_num)>Number(a))return!0}if(this.zs_click_award_num&&this.zs_click_award_num.length>0){if(1==this.zs_click_award_num.length&&-1==this.zs_click_award_num[0])return!0;if(-1!=this.zs_click_award_num.indexOf(e))return!0}return!1}static enableClickRevive(){return this.isReviveTypeEnable("zs_revive_click_num")}static updateClickRevive(){this.updateReviveTypeInfo("zs_revive_click_num")}static enableVideoRevive(){return this.isReviveTypeEnable("zs_revive_video_num")}static updateVideoRevive(){this.updateReviveTypeInfo("zs_revive_video_num")}static enableShareRevive(){return this.isReviveTypeEnable("zs_revive_share_num")}static updateShareRevive(){this.updateReviveTypeInfo("zs_revive_share_num")}static isReviveTypeEnable(e){if(0==this[e])return!1;if(-1==this[e])return!0;var t=s.LocalStorage.getItem(e+"_time_stamp");if(null==t||""==t||0==zs.laya.MiscUtils.isToday(Number(t)))return!0;var a=s.LocalStorage.getItem(e);return(null==a||""==a?0:Number(a))<this[e]}static updateReviveTypeInfo(e){s.LocalStorage.setItem(e+"_time_stamp",Date.now().toString());var t=s.LocalStorage.getItem(e),a=null==t||""==t?0:Number(t);a++,s.LocalStorage.setItem(e,a.toString())}static isBeforeGameAccount(){return a.zs_history_list_jump||a.zs_full_screen_jump}}a.response=null,a.zs_share_title="",a.zs_share_image="",a.zs_switch=!1,a.zs_version="1.0.0",a.zs_video_adunit="",a.zs_banner_adunit="",a.zs_full_screen_adunit="",a.zs_full_screen_ad_enable=!1,a.zs_banner_text_time=0,a.zs_banner_banner_time=0,a.zs_banner_refresh_time=0,a.zs_banner_move_time=500,a.zs_banner_vertical_enable=!1,a.zs_banner_horizontal_enable=!1,a.zs_jump_switch=!1,a.zs_revive_type=0,a.zs_revive_click_num=0,a.zs_revive_video_num=0,a.zs_revive_share_num=0,a.zs_continue_auto_share=!1,a.zs_full_screen_jump=!1,a.zs_history_list_jump=!1,a.zs_finish_jump=!1,a.zs_revive_countdown=10,a.zs_jump_style=1,a.zs_shield_gdt_export=!0,s.ILaya.regClass(a),s.ClassUtils.regClass("zs.laya.platform.ADConfig",a),s.ClassUtils.regClass("Zhise.ADConfig",a);class i extends s.Script{constructor(){super(),this.userId=null,this.adType=null,this.autoScroll=!1,this.scrollDir=i.SCROLL_NONE,this.dragSleep=5e3,this.scrollSpeed=5e3,this.passedTime=0,this.inAutoScroll=!1,this.adData=[],this.iosFilterAppIds=[],this.list=null,this.hotIds=[],this.maxNum=null,this.isDataUpdate=!1,this.touchIndex=-1,this.isRandomSelect=!1}requestAdData(e,s,t,a,n,r){this.userId=zs.laya.game.AppMain.playerInfo.user_id,this.adType=e,this.autoScroll=s,this.scrollDir=t,this.iosFilterAppIds=a||[],this.maxNum=n,this.isRandomSelect=r;var l=this;this.scrollDir==i.SCROLL_VERTICAL?this.list.vScrollBarSkin="":this.scrollDir==i.SCROLL_HORIZONTAL&&(this.list.hScrollBarSkin=""),zs.laya.zsapp.zsAppSdk.loadAd(function(e){l.adData=e[l.adType.toString()],l.initHotIds(),l.freshAdList()})}freshAdList(){var e=this;if(this.adData=this.adData.filter(function(t){return s.Browser.onAndroid||-1==e.iosFilterAppIds.indexOf(t.appid)}),null!=this.maxNum)if(this.adData.length<this.maxNum)for(;this.adData.length<this.maxNum;)this.adData.push(this.adData[Math.floor(Math.random()*this.adData.length)]);else if(this.adData.length>this.maxNum)for(;this.adData.length>this.maxNum;)this.adData.splice(Math.floor(Math.random()*this.adData.length),1);this.list.array=this.adData,this.autoScroll&&this.owner.frameOnce(1,this,this.startAutoScrollAd)}initHotIds(){var e=Math.random()<.5?3:4,s=Math.floor(this.adData.length/e);for(let t=0;t<e;t++)this.hotIds.push(Math.floor(s*Math.random())+t*s)}startAutoScrollAd(){this.inAutoScroll=!0;var e=this.list.repeatX?this.list.repeatX:1,s=this.list.repeatY?this.list.repeatY:1;if(this.scrollDir==i.SCROLL_VERTICAL){var t=this.list.array.length-this.list.array.length%e-e;this.autoScrollAd(0,t,t*this.scrollSpeed)}else if(this.scrollDir==i.SCROLL_HORIZONTAL){t=Math.ceil(this.list.array.length/s)-e;this.autoScrollAd(0,t,t*this.scrollSpeed)}}autoScrollAd(e,t,a){this.list.tweenTo(t,a,s.Handler.create(this,this.autoScrollAd,[t,e,a]))}onItemRender(e,s){var t=this.list.array[s];if(t){if(a=e.getChildByName("icon"))a.loadImage(t.app_icon,null);else{var a,i=e.getChildByName("iconBox");if(i)(a=i.getChildByName("icon"))&&(a.skin=t.app_icon)}var n=e.getChildByName("name");n&&(n.text=t.app_title);var r=e.getChildByName("desc");if(r&&(r.text=t.app_desc),1!=this.isDataUpdate){var l=e.getChildByName("titleBg");l&&(l.index=Math.floor(l.clipY*Math.random()));var o=e.getChildByName("tag");if(o)this.hotIds.indexOf(s)>0?(o.visible=!0,o.index=Math.floor(o.clipY*Math.random())):o.visible=!1;else{var h=e.getChildByName("hot"),d=e.getChildByName("new");h&&(h.visible=!1),d&&(d.visible=!1),this.hotIds.indexOf(s)>0&&(h&&d?Math.random()<.5?h.visible=!0:d.visible=!0:h&&!d?h.visible=!0:d&&!h&&(d.visible=!0))}}}else e.visible=!1}onTouchEnd(e){this.isRandomSelect&&-1==this.touchIndex&&(this.touchIndex=Math.floor(Math.random()*this.list.array.length),console.log("RandomSelect:"+this.touchIndex+" data list length:"+this.list.array.length)),this.onSelectAd(this.touchIndex),console.log("onTouchEnd:"+this.touchIndex),this.touchIndex=-1}onMouseAd(e,t){e.type==s.Event.MOUSE_DOWN&&(this.touchIndex=t),console.log(e.type,this.touchIndex)}onSelectAd(e){if(-1!=e){var t=this.list.array[e],a=this;a.isDataUpdate=!0,zs.laya.zsapp.zsAppSdk.navigate2Mini(t,this.userId,function(){s.stage.event(i.EVENT_NAVIGATE_SUCCESS)},function(){s.stage.event(i.EVENT_NAVIGATE_FAILED)},function(){a.list.selectedIndex=-1,s.stage.event(i.EVENT_NAVIGATE_COMPLETED)})}}params2String(e){var s=e[0]+"="+e[1];for(let t=2;t<e.length;t+=2)s+="&"+e[t]+"="+e[t+1];return s}onDragStateChanged(e){this.inAutoScroll=!1,this.autoScroll&&0==e&&(this.passedTime=0)}onAwake(){this.list=this.owner,this.list.selectEnable=!0,this.list.renderHandler=s.Handler.create(this,this.onItemRender,null,!1),this.list.mouseHandler=s.Handler.create(this,this.onMouseAd,null,!1),this.list.on(s.Event.MOUSE_UP,this,this.onDragStateChanged,[0]),this.list.on(s.Event.MOUSE_OUT,this,this.onDragStateChanged,[0]),this.list.on(s.Event.MOUSE_DOWN,this,this.onDragStateChanged,[1])}onEnable(){this.owner.on(s.Event.MOUSE_UP,this,this.onTouchEnd)}onDisable(){this.owner.off(s.Event.MOUSE_UP,this,this.onTouchEnd)}onUpdate(){this.list.array&&this.list.array.length>0&&this.autoScroll&&0==this.inAutoScroll&&(this.passedTime+=s.timer.delta,this.passedTime>this.dragSleep&&this.startAutoScrollAd())}}i.EVENT_NAVIGATE_SUCCESS="NAVIGATE_SUCCESS",i.EVENT_NAVIGATE_FAILED="NAVIGATE_FAILED",i.EVENT_NAVIGATE_COMPLETED="NAVIGATE_COMPLETED",i.SCROLL_NONE=0,i.SCROLL_VERTICAL=1,i.SCROLL_HORIZONTAL=2,s.ILaya.regClass(i),s.ClassUtils.regClass("zs.laya.platform.AdList",i),s.ClassUtils.regClass("Zhise.AdList",i);class n extends i{constructor(){super()}onItemRender(e,s){var t=this.list.array[s];if(t){if(1!=this.isDataUpdate){var a=e.getChildByName("icon");a&&(6!=s?(a.visible=!0,a.loadImage(t.app_icon,null)):a.visible=!1);var i=e.getChildByName("name");i&&(i.text=6!=s?t.app_title:"");var n=e.getChildByName("desc");n&&(n.text=6!=s?t.app_desc:"");var r=e.getChildByName("arrow");r&&(r.visible=6==s,6==s?(r.visible=!0,r.index=t.arrowIdx?t.arrowIdx:0):r.visible=!1)}}else e.visible=!1}onSelectAd(e){if(-1!=e){var t=this.list.array[e];if(6==e)return null==t.arrowIdx||0==t.arrowIdx?(t.arrowIdx=1,this.owner.event(n.EVENT_AD_SWITCH_SHOW)):(t.arrowIdx=0,this.owner.event(n.EVENT_AD_SWITCH_HIDE)),void(this.list.selectedIndex=-1);var a=this;a.isDataUpdate=!0,zs.laya.zsapp.zsAppSdk.navigate2Mini(t,this.userId,function(){s.stage.event(i.EVENT_NAVIGATE_SUCCESS)},function(){s.stage.event(i.EVENT_NAVIGATE_FAILED)},function(){a.list.selectedIndex=-1,s.stage.event(i.EVENT_NAVIGATE_COMPLETED)})}}}n.EVENT_AD_SWITCH_SHOW="EVENT_AD_SWITCH_SHOW",n.EVENT_AD_SWITCH_HIDE="EVENT_AD_SWITCH_HIDE",s.ILaya.regClass(n),s.ClassUtils.regClass("zs.laya.platform.AdList2",n),s.ClassUtils.regClass("Zhise.AdList2",n);class r extends s.Script{constructor(){super(),this.args=null,this.adView=null,this.monitorOtherPageOpen=!1}onEnable(){null==this.adView&&s.stage.on(zs.laya.game.EventId.AD_CONFIIG_LOADED,this,this.onStart)}onDisable(){null==this.adView&&s.stage.off(zs.laya.game.EventId.AD_CONFIIG_LOADED,this,this.onStart),this.monitorOtherPageOpen&&(s.stage.off(zs.laya.game.EventId.UI_VIEW_OPENED,this,this.onViewOpened),s.stage.off(zs.laya.game.EventId.UI_VIEW_CLOSED,this,this.onViewClosed))}onDestroy(){if(null!=this.adView){for(let e=0;e<this.adView.length;e++)null!=this.adView[e]&&this.adView[e].destroy();this.adView=null}}onStart(){if(!this.adView&&0!=a.zs_jump_switch&&0!=a.isPublicVersion()){var e=this.owner.url.substring(this.owner.url.lastIndexOf("/")+1,this.owner.url.lastIndexOf("."));if(this.args=t.platformCfg.exportGameCfg[e],this.args){this.monitorOtherPageOpen=!1,this.adView=[];for(let e=0;e<this.args.length;e++){const t=this.args[e];if(t.readonly)this.adView.push(null);else{if(null==t.checkKey||a[t.checkKey]){this.monitorOtherPageOpen=this.monitorOtherPageOpen||t.isHide,s.loader.create(t.viewUrl,s.Handler.create(this,this.onPrefabReady),null,s.Loader.PREFAB);break}this.adView.push(null)}}this.monitorOtherPageOpen&&(s.stage.on(zs.laya.game.EventId.UI_VIEW_OPENED,this,this.onViewOpened),s.stage.on(zs.laya.game.EventId.UI_VIEW_CLOSED,this,this.onViewClosed))}}}onPrefabReady(e){if(!this.destroyed){var t=this.args[this.adView.length],a=this.owner.url.substring(this.owner.url.lastIndexOf("/")+1,this.owner.url.lastIndexOf("."));if(this.owner.getChildByName(t.parentRoot)){var i=this.getViewScript(t.scriptType);if(null!=i){var n=e.create();this.owner.getChildByName(t.parentRoot).addChild(n),n.pos(t.x,t.y);var r=n.getComponent(i);null==r&&(r=n.addComponent(i)),t.adType&&r.initView(t),n.visible=this.owner.visible,this.adView.push(n),this.adView.length<this.args.length&&s.loader.create(this.args[this.adView.length].viewUrl,s.Handler.create(this,this.onPrefabReady),null,s.Loader.PREFAB)}else console.log(a+" page"+t.viewUrl+" scriptType is null")}else console.log(a+" page parentRoot "+t.parentRoot+" is null")}}getViewScript(e){switch(e){case"ExportScrollH":return l;case"ExportScrollV":return o;case"ExportScrollNone":return h;case"ShakeExportBox":return c;case"RankBtn":return g;case"InviteBtn":return m;case"FakeExitBtn":return p;case"FloatExportBtn":return _;case"ScreenExportBtn":return u;case"ExportLeftPop":return w;case"ExportRightPop":return f;case"ExportLeftFlyBox":return C}}onViewOpened(e){if(e&&this.adView)for(let e=0;e<this.adView.length;e++)null!=this.adView[e]&&(this.adView[e].visible=!1)}onViewClosed(e){if(e&&this.adView)for(let e=0;e<this.adView.length;e++)null!=this.adView[e]&&(this.adView[e].visible=!0)}}s.ILaya.regClass(r),s.ClassUtils.regClass("zs.laya.platform.ExportGameCtrl",r),s.ClassUtils.regClass("Zhise.ExportGameCtrl",r);class l extends s.Script{constructor(){super(),this.adList=null}initView(e){this.adList=this.owner.getChildByName("adList").addComponent(i);var s=t.platformCfg;this.adList.requestAdData(e.adType,!0,i.SCROLL_HORIZONTAL,s.iosFilterAppIds)}}s.ILaya.regClass(l),s.ClassUtils.regClass("zs.laya.platform.ExportScrollH",l),s.ClassUtils.regClass("Zhise.ExportScrollH",l);class o extends s.Script{constructor(){super(),this.adList=null}initView(e){this.adList=this.owner.getChildByName("adList").addComponent(i);var s=t.platformCfg;this.adList.requestAdData(e.adType,!0,i.SCROLL_VERTICAL,s.iosFilterAppIds)}}s.ILaya.regClass(o),s.ClassUtils.regClass("zs.laya.platform.ExportScrollV",o),s.ClassUtils.regClass("Zhise.ExportScrollV",o);class h extends s.Script{constructor(){super(),this.adList=null}initView(e){this.adList=this.owner.getChildByName("adList").addComponent(i);var s=t.platformCfg;this.adList.requestAdData(e.adType,!1,i.SCROLL_NONE,s.iosFilterAppIds,3)}}s.ILaya.regClass(h),s.ClassUtils.regClass("zs.laya.platform.ExportScrollNone",h),s.ClassUtils.regClass("Zhise.ExportScrollNone",h);class d extends s.Script{constructor(){super(),this.list=null,this.adType=0,this.delayAnimTime=1e3,this.animIntervalTime=4e3,this.animDuaration=500,this.adIdx=0,this.rotOffset=10,this.loopTime=2,this.adData=null,this.subAnimDuaration=0}requestAdData(){var e=this;zs.laya.zsapp.zsAppSdk.loadAd(t=>{var a=t[e.adType.toString()];a=a.filter(e=>s.Browser.onAndroid||"wx48820730357d81a6"!=e.appid&&"wxc136d75bfc63107c"!=e.appid),e.adIdx%=a.length,e.initAd(a[e.adIdx])})}initAd(e){this.onItemRender(e),this.owner.timerLoop(this.delayAnimTime+this.animIntervalTime,this,this.freshAdItems)}freshAdItems(){var e=this;this.adIdx+=4,zs.laya.zsapp.zsAppSdk.loadAd(t=>{var a=t[e.adType.toString()];a=a.filter(e=>s.Browser.onAndroid||"wx48820730357d81a6"!=e.appid&&"wxc136d75bfc63107c"!=e.appid),e.adIdx%=a.length,e.onItemRender(a[e.adIdx])}),this.playShakeAnim(0)}playShakeAnim(e){if(!(e/4>=this.loopTime)){var t=this.owner;switch(e%4){case 0:s.Tween.to(t,{rotation:this.rotOffset},this.subAnimDuaration,s.Ease.linearNone,s.Handler.create(this,this.playShakeAnim,[e+1]));break;case 1:s.Tween.to(t,{rotation:0},this.subAnimDuaration,s.Ease.linearNone,s.Handler.create(this,this.playShakeAnim,[e+1]));break;case 2:s.Tween.to(t,{rotation:this.rotOffset},this.subAnimDuaration,s.Ease.linearNone,s.Handler.create(this,this.playShakeAnim,[e+1]));break;case 3:s.Tween.to(t,{rotation:0},this.subAnimDuaration,s.Ease.linearNone,s.Handler.create(this,this.playShakeAnim,[e+1]))}}}onItemRender(e){if(null!=e){this.adData=e,this.owner.visible=!0;var s=this.owner,t=e,a=s.getChildByName("icon");a&&a.loadImage(t.app_icon,null);var i=s.getChildByName("name");i&&(i.text=t.app_title);var n=s.getChildByName("desc");n&&(n.text=t.app_desc)}else null==this.addData&&(this.owner.visible=!1)}onClick(){null!=this.adData&&zs.laya.zsapp.zsAppSdk.navigate2Mini(this.adData,zs.laya.game.AppMain.playerInfo.user_id,()=>{s.stage.event(zs.laya.game.EventId.APP_JUMP_SUCCESS)},()=>{s.stage.event(zs.laya.game.EventId.APP_JUMP_CANCEL)},()=>{})}onStart(){this.subAnimDuaration=this.animDuaration/(4*this.loopTime),this.requestAdData()}}s.ILaya.regClass(d),s.ClassUtils.regClass("zs.laya.platform.ShakeExportIcon",d),s.ClassUtils.regClass("Zhise.ShakeExportIcon",d);class c extends s.Script{constructor(){super()}initView(e){for(let s=0;s<this.owner.numChildren;s++){const t=this.owner.getChildAt(s).addComponent(d);t.adIdx=s,t.adType=e.adType}}}s.ILaya.regClass(c),s.ClassUtils.regClass("zs.laya.platform.ShakeExportBox",c),s.ClassUtils.regClass("Zhise.ShakeExportBox",c);class p extends s.Script{constructor(){super()}onAwake(){this.owner.mouseEnabled=!0,this.owner.visible=a.zs_jump_switch&&a.isPublicVersion()&&a.zs_history_list_jump}onClick(){s.SoundManager.playSound(zs.laya.game.AppMain.appConfig.soundClick),this.owner.mouseEnabled=!1,zs.laya.game.UIService.showListAd(),this.owner.mouseEnabled=!0}}s.ILaya.regClass(p),s.ClassUtils.regClass("zs.laya.ui.FakeExitBtn",p),s.ClassUtils.regClass("Zhise.FakeExitBtn",p);class _ extends s.Script{constructor(){super()}onAwake(){this.owner.mouseEnabled=!0,this.owner.visible=a.zs_jump_switch&&a.isPublicVersion()&&a.zs_history_list_jump}onClick(){s.SoundManager.playSound(zs.laya.game.AppMain.appConfig.soundClick),this.owner.mouseEnabled=!1,zs.laya.game.UIService.showHomeFloatAd(),this.owner.mouseEnabled=!0}}s.ILaya.regClass(_),s.ClassUtils.regClass("zs.laya.ui.FloatExportBtn",_),s.ClassUtils.regClass("Zhise.FloatExportBtn",_);class u extends s.Script{constructor(){super()}onAwake(){this.owner.mouseEnabled=!0,this.owner.visible=a.zs_jump_switch&&a.isPublicVersion()&&a.zs_history_list_jump}onClick(){s.SoundManager.playSound(zs.laya.game.AppMain.appConfig.soundClick),this.owner.mouseEnabled=!1,zs.laya.game.UIService.showScreenAd(),this.owner.mouseEnabled=!0}}s.ILaya.regClass(u),s.ClassUtils.regClass("zs.laya.ui.ScreenExportBtn",u),s.ClassUtils.regClass("Zhise.ScreenExportBtn",u);class m extends s.Script{constructor(){super()}onClick(){console.log("openInvite"),s.SoundManager.playSound(zs.laya.game.AppMain.appConfig.soundClick),zs.laya.sdk.SdkService.openShare(zs.laya.platform.ADConfig.zs_share_title,zs.laya.platform.ADConfig.zs_share_image)}}s.ILaya.regClass(m),s.ClassUtils.regClass("zs.laya.platform.InviteBtn",m),s.ClassUtils.regClass("Zhise.InviteBtn",m);class g extends s.Script{constructor(){super()}onEnable(){zs.laya.sdk.SdkService.showUserInfoButton()}onDisable(){zs.laya.sdk.SdkService.hideUserInfoButton()}onAwake(){var e=this.owner,t=this.owner.parent,a=new s.Rectangle;a.x=(e.x+ +t.x)/s.stage.width,a.y=(e.y+t.y)/s.stage.height,a.width=e.width/s.stage.width,a.height=e.height/s.stage.height,zs.laya.sdk.SdkService.createUserInfoButton(a,s.Handler.create(this,this.openRank,null,!1)),zs.laya.sdk.SdkService.showUserInfoButton()}onDestroy(){zs.laya.sdk.SdkService.hideUserInfoButton(),zs.laya.sdk.SdkService.destroyUserInfoButton()}openRank(e){if(s.SoundManager.playSound(zs.laya.game.AppMain.appConfig.soundClick),console.log("openRank"),e&&null!=e.rawData){zs.laya.game.UIService.showRank(),zs.laya.sdk.SdkService.hideUserInfoButton();var t=JSON.parse(e.rawData);zs.laya.game.AppMain.authorizeData=JSON.parse(e.rawData),zs.laya.game.WebService.requestAuthorize(t.nickName,t.avatarUrl,t.gender)}}}s.ILaya.regClass(g),s.ClassUtils.regClass("zs.laya.platform.RankBtn",g),s.ClassUtils.regClass("Zhise.RankBtn",g);class w extends s.Script{constructor(){super(),this.srcX=0,this.adList=null,this.adCheckBox=null}initView(e){this.srcX=this.owner.x,this.adList=this.owner.getChildByName("adList").addComponent(i),this.adCheckBox=this.owner.getChildByName("adCheckBox"),this.adCheckBox.on(s.Event.CLICK,this,this.updateFloatPos);var a=t.platformCfg;this.adList.requestAdData(e.adType,!0,i.SCROLL_NONE,a.iosFilterAppIds)}onDestroy(){this.adCheckBox.off(s.Event.CLICK,this,this.updateFloatPos)}updateFloatPos(){zs.laya.sdk.SdkService.hideUserInfoButton(),this.adCheckBox.mouseEnabled=!1,this.adCheckBox.selected?s.Tween.to(this.owner,{x:0},500,null,s.Handler.create(this,this.onTweenCompleted)):s.Tween.to(this.owner,{x:this.srcX},500,null,s.Handler.create(this,this.onTweenCompleted))}onTweenCompleted(){this.adCheckBox.mouseEnabled=!0,0==this.adCheckBox.selected&&zs.laya.sdk.SdkService.showUserInfoButton()}}s.ILaya.regClass(w),s.ClassUtils.regClass("zs.laya.platform.ExportLeftPop",w),s.ClassUtils.regClass("Zhise.ExportLeftPop",w);class f extends s.Script{constructor(){super(),this.adFrame=null,this.adList=null}initView(e){this.adFrame=this.owner.getChildByName("adFrame"),this.adList=this.owner.getChildByName("adList").addComponent(n);var s=t.platformCfg;this.adList.requestAdData(e.adType,!1,i.SCROLL_NONE,s.iosFilterAppIds,9),this.adList.owner.on(n.EVENT_AD_SWITCH_HIDE,this,this.onAdHide),this.adList.owner.on(n.EVENT_AD_SWITCH_SHOW,this,this.onAdShow)}onAdHide(){this.adList.owner.mouseEnabled=!1,s.Tween.to(this.owner,{x:-150},500,null,s.Handler.create(this,this.onTweenCompleted))}onAdShow(){this.adList.owner.mouseEnabled=!1,s.Tween.to(this.owner,{x:-450},500,null,s.Handler.create(this,this.onTweenCompleted))}onTweenCompleted(){this.adList.owner.mouseEnabled=!0}}s.ILaya.regClass(f),s.ClassUtils.regClass("zs.laya.platform.ExportRightPop",f),s.ClassUtils.regClass("Zhise.ExportRightPop",f);class C extends s.Script{constructor(){super(),this.isClick=!1,this.adData=[],this.unData=[]}initView(e){if(a.zs_jump_switch&&a.isPublicVersion()){for(let e=0;e<6;e++){let t=this.owner.getChildByName("ad_"+e);t&&s.Tween.from(t,{rotation:360,x:t.x-500},700,null,s.Handler.create(this,()=>{this.isClick=!0}))}var t=e.adType.toString();zs.laya.zsapp.zsAppSdk.loadAd(e=>{this.adData=e[t],this.freshAdBox()})}else this.owner.visible=!1}freshAdBox(){var e=t.platformCfg;if(this.adData=this.adData.filter(function(t){return s.Browser.onAndroid||-1==e.iosFilterAppIds.indexOf(t.appid)}),this.adData.length<6)for(;this.adData.length<6;)this.adData.push(this.adData[Math.floor(Math.random()*this.adData.length)]);else if(this.adData.length>6)for(;this.adData.length>6;){let e=this.adData.splice(Math.floor(Math.random()*this.adData.length),1);this.unData.push(e[0])}for(let e=0;e<6;e++){let t=this.owner.getChildByName("ad_"+e);if(t){let a=t.getChildByName("icon");a&&a.loadImage(this.adData[e].app_icon,null),t.on(s.Event.CLICK,this,this.onBoxClick,[e])}}}onBoxClick(e){if(this.isClick&&(zs.laya.zsapp.zsAppSdk.navigate2Mini(this.adData[e],this.userId,function(){s.stage.event(EventId.APP_JUMP_SUCCESS)},function(){s.stage.event(EventId.APP_JUMP_CANCEL)},function(){}),this.unData.length>0)){let s=this.unData.splice(Math.floor(Math.random()*this.unData.length),1);this.unData.push(this.adData.splice(e,1,s[0])[0]);let t=this.owner.getChildByName("ad_"+e);if(t){let s=t.getChildByName("icon");s&&s.loadImage(this.adData[e].app_icon,null)}}}}s.ILaya.regClass(C),s.ClassUtils.regClass("zs.laya.platform.ExportLeftFlyBox",C),s.ClassUtils.regClass("Zhise.ExportLeftFlyBox",C);class y extends zs.laya.base.ZhiSeView{constructor(){super(),this.adList=null,this.closeBtn=null}onAwake(){super.onAwake();var e=this.owner.getChildByName("middleUI");this.adList=e.getChildByName("adList").addComponent(i),this.closeBtn=e.getChildByName("closeBtn"),this.closeBtn.on(s.Event.CLICK,this,this.closeView)}onDestroy(){this.closeBtn.off(s.Event.CLICK,this,this.closeView)}onStart(){var e=this.owner.url.substring(this.owner.url.lastIndexOf("/")+1,this.owner.url.lastIndexOf(".")),s=t.platformCfg.exportGameCfg[e],a=t.platformCfg;this.adList.requestAdData(s?s[0].adType:"promotion",!1,i.SCROLL_NONE,a.iosFilterAppIds,9)}closeView(){s.SoundManager.playSound(zs.laya.game.AppMain.appConfig.soundClick),this.owner.close(),a.zs_history_list_jump&&(!zs.laya.game.AppMain.playerInfo.is_new||null!=zs.laya.game.AppMain.playerInfo.is_new&&0==zs.laya.game.AppMain.playerInfo.is_new)&&zs.laya.game.UIService.showListAd()}}s.ILaya.regClass(y),s.ClassUtils.regClass("zs.laya.platform.HomeFloatAdView",y),s.ClassUtils.regClass("Zhise.HomeFloatAdView",y);class z extends zs.laya.base.ZhiSeView{constructor(){super(),this.headAdList=null,this.mainAdList=null,this.closeBtn=null}onAwake(){super.onAwake();var e=this.owner.getChildByName("middleUI");this.headAdList=e.getChildByName("headAdList").addComponent(i),this.mainAdList=e.getChildByName("mainAdList").addComponent(i),this.closeBtn=e.getChildByName("closeBtn"),this.closeBtn.on(s.Event.CLICK,this,this.closeView),this.continueBtn=e.getChildByName("continueBtn"),this.continueBtn.on(s.Event.CLICK,this,this.closeView)}onDestroy(){this.closeBtn.off(s.Event.CLICK,this,this.closeView),this.continueBtn.off(s.Event.CLICK,this,this.closeView)}onStart(){var e=this.owner.url.substring(this.owner.url.lastIndexOf("/")+1,this.owner.url.lastIndexOf(".")),s=t.platformCfg.exportGameCfg[e],a=s?s[0].adType:"promotion",n=t.platformCfg;this.headAdList.requestAdData(a,!0,i.SCROLL_HORIZONTAL,n.iosFilterAppIds),this.mainAdList.requestAdData(a,!0,i.SCROLL_VERTICAL,n.iosFilterAppIds,null,!0)}closeView(){s.SoundManager.playSound(zs.laya.game.AppMain.appConfig.soundClick),this.owner.close()}}s.ILaya.regClass(z),s.ClassUtils.regClass("zs.laya.platform.FullScreeAdView",z),s.ClassUtils.regClass("Zhise.FullScreeAdView",z);class v extends zs.laya.base.ZhiSeView{constructor(){super(),this.adList=null,this.closeBtn=null}onAwake(){super.onAwake();var e=this.owner.getChildByName("topUI");this.adList=e.getChildByName("adList").addComponent(i),this.closeBtn=e.getChildByName("topFrame").getChildByName("closeBtn"),this.closeBtn.on(s.Event.CLICK,this,this.closeView)}onDestroy(){this.closeBtn.off(s.Event.CLICK,this,this.closeView)}onStart(){var e=this.owner.url.substring(this.owner.url.lastIndexOf("/")+1,this.owner.url.lastIndexOf(".")),s=t.platformCfg.exportGameCfg[e],a=t.platformCfg;this.adList.requestAdData(s?s[0].adType:"promotion",!1,i.SCROLL_VERTICAL,a.iosFilterAppIds,null,!0)}closeView(){s.SoundManager.playSound(zs.laya.game.AppMain.appConfig.soundClick),this.owner.close()}}s.ILaya.regClass(v),s.ClassUtils.regClass("zs.laya.platform.ListAdView",v),s.ClassUtils.regClass("Zhise.ListAdView",v);class I extends zs.laya.base.ZhiSeView{constructor(){super()}onAwake(){super.onAwake(),this.initData();var e=this.owner.url.substring(this.owner.url.lastIndexOf("/")+1,this.owner.url.lastIndexOf(".")),a=t.platformCfg.exportGameCfg[e],i=(a&&a[0].adType,t.platformCfg,this.owner.getChildByName("bottomUI"));i&&(this.btn_repair=i.getChildByName("eggBtn"));var n=this.owner.getChildByName("middleUI"),r=this.eggUI=n.getChildByName("eggUI");r&&(this.btn_repair||(this.btn_repair=r.getChildByName("eggBtn")),this.progressBar=r.getChildByName("loading_1"),this.progressWidth=this.progressBar.bitmap.width,this.progressHeight=this.progressBar.bitmap.height),this.bannerMoveType=0,this.initCfg(),s.stage.on(zs.laya.game.EventId.APP_HIDE,this,this.onAppHide),s.stage.on(zs.laya.game.EventId.APP_SHOW,this,this.onAppShow),this.btn_repair&&(this.btn_repair.on(s.Event.MOUSE_DOWN,this,this.onTouchStart),this.btn_repair.on(s.Event.MOUSE_UP,this,this.clickHammer)),this.hammerAni=this.owner.knockAni}initCfg(){this.knockEggCfg=s.loader.getRes("config/KnockEggCfg.json"),this.awardDelay=1e3,this.closeDelay=1e3,this.knockEggCfg&&(zs.laya.MiscUtils.IsNumber(this.knockEggCfg.awardDelay)&&(this.awardDelay=Number(this.knockEggCfg.awardDelay)),zs.laya.MiscUtils.IsNumber(this.knockEggCfg.closeDelay)&&(this.closeDelay=Number(this.knockEggCfg.closeDelay)))}isShowAward(){return this.knockEggCfg&&this.knockEggCfg.isShowAward}onTouchStart(e){this.lastMouseX=s.stage.mouseX,this.lastMouseY=s.stage.mouseY}initData(){this.btn_repair=null,this.progressBar=null,this.hammerAni=null,this.egg=null,this.touchNode=null,this.repairProgress=0,this.click_add_percent=.14,this.isOpenAd=!1,this.repair_click_num=[.3,.7],this.showBannerRange=1,this.isGetAward=!1,this.callback=null}onEnable(){super.onEnable(),this.initBannerGroup(),this.initRepair()}onDisable(){super.onDisable()}onDestroy(){this.removeEvent(),super.onDestroy()}removeEvent(){s.timer.clear(this,this.cutBack),s.stage.off(zs.laya.game.EventId.APP_HIDE,this,this.onAppHide),s.stage.off(zs.laya.game.EventId.APP_SHOW,this,this.onAppShow),this.btn_repair&&(this.btn_repair.off(s.Event.MOUSE_DOWN,this,this.onTouchStart),this.btn_repair.off(s.Event.MOUSE_UP,this,this.clickHammer))}onAppHide(){if(this.isOpenAd){this.btn_repair&&(this.btn_repair.off(s.Event.MOUSE_DOWN,this,this.onTouchStart),this.btn_repair.off(s.Event.MOUSE_UP,this,this.clickHammer)),this.isOpenAd=!0,s.timer.clear(this,this.resetIsOpenAd),s.timer.clear(this,this.cutBack);var e=s.LocalStorage.getItem("open_award_num")||0;s.LocalStorage.setItem("open_award_num",Number(e)+1),this.isShowAward()||this.onFinish()}}initBannerGroup(){var e=t.platformCfg.bannerCfg;if(e){this.viewName=this.owner.url,this.viewName=this.viewName.substring(this.viewName.lastIndexOf("/")+1,this.viewName.lastIndexOf("."));var s=e[this.viewName];if(s){var a=s.showData;if(a){(a.sign||0==a.sign||0==a.sign)&&(this.bannerGroup=zs.laya.banner.WxBannerMgr.Instance.getBannerGroup(a.sign),this.bannerGroup&&this.bannerGroup.hide());var i=a.moveType;1==i&&(this.bannerMoveType=i)}else console.error("==============initBannerGroup===============",s.showData)}}}onAppShow(){this.isOpenAd&&(this.bannerGroup&&this.bannerGroup.hide(),this.isShowAward()&&this.onFinish())}initRepair(){this.isGetAward=!1,a.openEggTimes=zs.laya.MiscUtils.IsNumber(a.openEggTimes)?Number(a.openEggTimes)+1:1,s.timer.loop(20,this,this.cutBack),a.zs_click_award_percent.indexOf("[")>=0?this.repair_click_num=JSON.parse(a.zs_click_award_percent):this.repair_click_num=a.zs_click_award_percent.split(","),this.click_add_percent=a.zs_click_award_add,this.zs_click_award_back=a.zs_click_award_back,this.click_add_percent=.01*zs.laya.MiscUtils.random(.9*this.click_add_percent*100,1.1*this.click_add_percent*100),console.log("===============repair_click_num=====================",this.repair_click_num),this.showBannerRange=.01*zs.laya.MiscUtils.random(100*Number(this.repair_click_num[0]),100*Number(this.repair_click_num[1]))}setCloseCallback(e){this.callback=e}clickHammer(){if(this.repairProgress+this.click_add_percent<=1){if(this.updateRepairPorgress(this.repairProgress+this.click_add_percent),this.hammerAni&&this.hammerAni.play(0,!1),this.repairProgress>=this.showBannerRange&&!this.isOpenAd){switch(this.isOpenAd=!0,this.bannerMoveType){case 1:this.bannerGroup&&this.bannerGroup.updateY(this.lastMouseY);break;default:this.bannerGroup&&this.bannerGroup.updateBottonTouch()}this.bannerGroup&&this.bannerGroup.show(),s.timer.once(800,this,this.resetIsOpenAd),s.timer.once(800,this,function(){this.initBannerGroup(),this.bannerGroup&&this.bannerGroup.hide()})}}else this.updateRepairPorgress(this.repairProgress+this.click_add_percent),this.bannerGroup&&this.bannerGroup.hide(),s.timer.clear(this,this.cutBack),s.timer.clear(this,this.resetIsOpenAd),this.onFinish()}resetIsOpenAd(){this.isOpenAd=!1}onFinish(){this.isGetAward||(this.isGetAward=!0,s.timer.once(this.awardDelay,this,()=>{s.stage.event(zs.laya.game.EventId.EGG_GET_AWARD)}),s.timer.once(Math.max(this.closeDelay,this.awardDelay+40),this,this.onClose))}onClose(){console.log("====================关闭金蛋=================="),this.callback&&this.callback(),this.bannerGroup&&this.bannerGroup.hide(),this.owner.close()}updateRepairPorgress(e){this.repairProgress=Math.min(1,Math.max(0,e)),this.progressWidth<this.progressHeight?this.progressBar&&(this.progressBar.height=this.progressBar.clipHeight=Math.max(1,this.progressHeight*this.repairProgress)):this.progressBar&&(this.progressBar.width=Math.max(1,this.progressWidth*this.repairProgress))}cutBack(){this.repairProgress-=this.zs_click_award_back,this.updateRepairPorgress(this.repairProgress)}}s.ILaya.regClass(I),s.ClassUtils.regClass("zs.laya.platform.KnockEggView",I),s.ClassUtils.regClass("Zhise.KnockEggView",I);class S extends zs.laya.base.ZhiSeView{constructor(){S.__super.call(this),this.closeBtn=null,this.openView=null}onAwake(){super.onAwake(),this.openView=this.owner.getChildByName("fullUI"),this.closeBtn=this.owner.getChildByName("closeBtn")}onEnable(){zs.laya.sdk.SdkService.hideUserInfoButton()}onDisable(){zs.laya.sdk.SdkService.showUserInfoButton()}onStart(){s.Browser.onMiniGame&&(this.openView.postMsg(new zs.laya.opendata.MainScopeMsg(zs.laya.opendata.EventDefine.OpenRank,{userId:zs.laya.game.AppMain.playerInfo.user_id,atlasUrl:this.AtlasURL})),s.loader.load(this.AtlasURL,s.Handler.create(this,function(){s.MiniAdpter.sendAtlasToOpenDataContext(S.AtlasURL)}))),s.stage.on(EventId.NET_XHR_RESPONSE,this,this.onRankDataReady),zs.laya.game.WebService.requestTopRank(),this.closeBtn&&this.closeBtn.on(s.Event.CLICK,this,this.closeRank)}onDestroy(){this.closeBtn&&this.closeBtn.off(s.Event.CLICK,this,this.closeRank)}closeRank(){s.Browser.onMiniGame&&this.openView.postMsg(new zs.laya.opendata.MainScopeMsg(zs.laya.opendata.EventDefine.CloseRank)),zs.laya.game.UIService.hideRank(),s.SoundManager.playSound(zs.laya.game.AppMain.appConfig.soundClick)}onRankDataReady(e,t,a,i){if(t==zs.laya.game.WebService.WebApiMap.worldRank&&1==e&&(s.stage.off(EventId.NET_XHR_RESPONSE,this,this.onRankDataReady),i&&i.data&&i.data.list&&s.Browser.onMiniGame)){var n=[],r=i.data.list,l=zs.laya.game.AppMain.playerInfo.user_id;r.forEach(function(e,s){n.push(new zs.laya.opendata.RankData(s+1,e.avatar,e.nickname,e.max_score,e.user_id==l))}),this.openView.postMsg(new zs.laya.opendata.MainScopeMsg(zs.laya.opendata.EventDefine.ShowRank,{rankType:zs.laya.opendata.RankType.WorldRank,rankData:n}))}}}S.AtlasURL="res/atlas/rankUI.atlas",s.ILaya.regClass(S),s.ClassUtils.regClass("zs.laya.platform.RankView",S),s.ClassUtils.regClass("Zhise.RankView",S);class A extends s.Script{constructor(){super(),this.args=null,this.adView=null}onDestroy(){if(this.adView){var e=this.getViewScript(this.args.scriptType);null==e&&(e=b);var s=this.adView.getComponent(e);s&&s.releaseView(),this.adView.removeSelf(),this.adView=null}}onStart(){if(this.adView)this.adView.visible=!0;else if(!(zs.laya.zsapp.zsAppSdk.Instance&&zs.laya.zsapp.zsAppSdk.Instance.isFromLink()&&0==zs.laya.zsapp.zsAppSdk.Instance.isExportValid()||0==a.zs_jump_switch||0==a.isPublicVersion())){var e=this.owner.url.substring(this.owner.url.lastIndexOf("/")+1,this.owner.url.lastIndexOf("."));this.args=t.platformCfg.nativeAdCfg[e],this.args&&s.loader.create(this.args.viewUrl,s.Handler.create(this,this.onPrefabReady),null,s.Loader.PREFAB)}}onPrefabReady(e){if(!this.destroyed)if(this.owner.getChildByName(this.args.parentRoot)){this.adView=e.create(),this.owner.getChildByName(this.args.parentRoot).addChild(this.adView),this.adView.x=this.args.x,this.adView.y=this.args.y;var s=this.getViewScript(this.args.scriptType);null==s&&(s=b);var t=this.adView.getComponent(s);null==t&&(t=this.adView.addComponent(s)),t.initView(this.args)}else console.log(viewName+" page parentRoot "+this.args.parentRoot+" is null")}getViewScript(e){switch(e){case"NativeIconAdView":return b}}}s.ILaya.regClass(A),s.ClassUtils.regClass("zs.laya.platform.NativeAdsCtrl",A),s.ClassUtils.regClass("Zhise.NativeAdsCtrl",A);class b extends s.Script{constructor(){super(),this.gameIcon=null,this.config=null,this.maskViewNum=0,this.iconReady=!1}initView(e){this.config=e,this.maskViewNum=0,this.iconReady=!1;var t=s.stage.getChildByName("root");for(let e=t.numChildren-1;e>=0;e--){var a=t.getChildAt(e);a.zOrder&&a.zOrder>this.owner.zOrder&&this.maskViewNum++,console.log("stage:"+a.name)}s.stage.on(zs.laya.game.EventId.UI_VIEW_OPENED,this,this.onViewOpened),s.stage.on(zs.laya.game.EventId.UI_VIEW_CLOSED,this,this.onViewClosed)}onStart(){var e=[],s="undefined"!=typeof wx;if(0!=s){var t=wx.getSystemInfoSync();if(s=zs.laya.MiscUtils.compareVersion(t.SDKVersion,"2.8.2")>=0,this.owner.visible=s,0!=s&&(this.updateIconStyle(e,t),0!=e.length&&(console.log(e),this.gameIcon=wx.createGameIcon({adUnitId:a.response[this.config.idKey],count:e.length,style:e}),this.gameIcon))){console.log("load gameIcon");var i=this;this.gameIcon.onError(function(e){console.error(e),i.gameIcon=null}),this.gameIcon.load(),this.gameIcon.onLoad(function(){console.log("gameIcon loaded"),i.iconReady=!0,0==i.maskViewNum&&i.owner.visible&&i.gameIcon.show()})}}}onEnable(){this.gameIcon&&this.gameIcon.show()}onDisable(){this.gameIcon&&this.gameIcon.hide()}updateIconStyle(e,t){var a=this.owner.getChildByName("container");if(null!=a)for(let n=0;n<a.numChildren;n++){const r=a.getChildAt(n);r.visible=!1;var i=this.owner.localToGlobal(new s.Point(r.x,r.y),!0);e.push({appNameHidden:!0,color:"white",borderWidth:1,borderColor:"white",top:i.y/s.stage.height*t.windowHeight,left:i.x/s.stage.width*t.windowWidth,size:r.width/s.stage.width*t.windowWidth})}}releaseView(){this.maskViewNum=-1,s.stage.off(zs.laya.game.EventId.UI_VIEW_OPENED,this,this.onViewOpened),s.stage.off(zs.laya.game.EventId.UI_VIEW_CLOSED,this,this.onViewClosed),this.gameIcon&&(this.gameIcon.destroy(),this.gameIcon=null)}onViewOpened(e,s){s.zOrder>this.owner.zOrder&&this.maskViewNum++,0!=this.maskViewNum&&this.gameIcon&&this.iconReady&&this.gameIcon.hide()}onViewClosed(e,s){s.zOrder>this.owner.zOrder&&this.maskViewNum--,0==this.maskViewNum&&this.gameIcon&&this.iconReady&&this.gameIcon.show()}}s.ILaya.regClass(b),s.ClassUtils.regClass("zs.laya.platform.NativeIconAdView",b),s.ClassUtils.regClass("Zhise.NativeIconAdView",b);class E extends s.Script{constructor(){super()}onAwake(){if(1==a.isPublicVersion()){var e=this.owner.url.substring(this.owner.url.lastIndexOf("/")+1,this.owner.url.lastIndexOf(".")),s=t.platformCfg.mistakenlyTouchCfg[e];if(s)for(let e=0;e<s.length;e++){const t=s[e],r=this.findChildByPath(t.path);var i=r.x,n=r.y;a.zs_switch&&(a.zs_banner_vertical_enable?(r.x+=t.offsetX,r.y+=t.offsetY,this.owner.timerOnce(a.zs_banner_text_time,this,this.moveBack,[i,n,a.zs_banner_move_time,r],!1)):a.zs_unmiss_text_time>0&&(r.visible=!1,this.owner.timerOnce(a.zs_unmiss_text_time,this,this.showObj,[r],!1)))}}}onStart(){if(1==a.isPublicVersion()){var e=this.owner.url.substring(this.owner.url.lastIndexOf("/")+1,this.owner.url.lastIndexOf(".")),s=t.platformCfg.mistakenlyTouchCfg[e];if(s)for(let e=0;e<s.length;e++){const t=s[e],i=this.findChildByPath(t.path);a.zs_switch&&a.zs_banner_vertical_enable&&(i.x+=t.offsetX,i.y+=t.offsetY,i.mouseEnabled=!1)}}}moveBack(e,t,a,i){s.Tween.to(i,{x:e,y:t},a,null,s.Handler.create(this,this.activeObj,[i]))}activeObj(e){e.visible=!1,e.mouseEnabled=!0,e.visible=!0}showObj(e){e.visible=!0,e.mouseEnabled=!0}findChildByPath(e){var s=e.split("/"),t=this.owner;for(let e=0;e<s.length;e++)t=t.getChildByName(s[e]);return t}}s.ILaya.regClass(E),s.ClassUtils.regClass("zs.laya.platform.MistakenlyTouchCtrl",E),s.ClassUtils.regClass("Zhise.MistakenlyTouchCtrl",E);class k extends s.Script{onEnable(){this.viewName=this.owner.url,this.viewName=this.viewName.substring(this.viewName.lastIndexOf("/")+1,this.viewName.lastIndexOf("."));var e=t.platformCfg.bannerCfg;if(e){var i=e[this.viewName];if(i){var n=i.initGroupArr;if(n){console.log("setAdUnitId:",a.zs_banner_rotate_id1,a.zs_banner_rotate_id2,a.zs_banner_rotate_id3),zs.laya.banner.WxBannerMgr.Instance.setAdUnitId(a.zs_banner_rotate_id1,a.zs_banner_rotate_id2,a.zs_banner_rotate_id3);for(let e=0;e<n.length;e++){const s=n[e];zs.laya.banner.WxBannerMgr.Instance.initBannerGroupBySign(s.sign,s.length,s.autoChange,s.isReset)}}console.log("==================",this.viewName,"=================",i);var r=i.showData;if(r&&(zs.laya.banner.WxBannerMgr.Instance.hideAllShow(),!r.unAutoShow&&(r.sign||0==r.sign||0==r.sign))){var l=zs.laya.banner.WxBannerMgr.Instance.getBannerGroup(r.sign);r.isDelay&&a.zs_banner_banner_time?s.timer.once(a.zs_banner_banner_time,this,this.showBanner,[l]):this.showBanner(l)}var o=i.exposureData;if(o){if(1==i.pageType){if(!a.zs_full_screen_rotate)return;zs.laya.banner.WxBannerMgr.Instance.lockHideExposure()}if(o.sign||0==o.sign||0==o.sign){l=zs.laya.banner.WxBannerMgr.Instance.getBannerGroup(o.sign);var h=o.anchorArr;if(h)for(let e=0;e<h.length;e++){const s=h[e];l&&l.showExposure(zs.laya.banner.WxBanner[s])}}}i.lockHide&&zs.laya.banner.WxBannerMgr.Instance.lockHide()}}}showBanner(e){e&&e.updateBottonTouch(),e&&e.show()}onDisable(){this.viewName=this.owner.url,this.viewName=this.viewName.substring(this.viewName.lastIndexOf("/")+1,this.viewName.lastIndexOf("."));var e=t.platformCfg.bannerCfg;if(e){var a=e[this.viewName];if(a){var i=a.showData;if(i)if(i.sign||0==i.sign||0==i.sign)s.timer.clear(this,this.showBanner),(r=zs.laya.banner.WxBannerMgr.Instance.getBannerGroup(i.sign))&&r.hide();var n=a.exposureData;if(n){var r;if(1==a.pageType){if(!zs.laya.platform.ADConfig.zs_full_screen_rotate)return;zs.laya.banner.WxBannerMgr.Instance.hideResumeExposure()}if(n.sign||0==n.sign||0==n.sign)(r=zs.laya.banner.WxBannerMgr.Instance.getBannerGroup(n.sign))&&r.hideExposure()}a.lockHide&&zs.laya.banner.WxBannerMgr.Instance.hideResume()}}}}s.ILaya.regClass(k),s.ClassUtils.regClass("zs.laya.platform.BannerCtrl",k),s.ClassUtils.regClass("Zhise.BannerCtrl",k),e.PlatformMgr=t,e.ADConfig=a,e.ExportGameCtrl=r,e.NativeAdsCtrl=A,e.MistakenlyTouchCtrl=E,e.BannerCtrl=k}(window.zs.laya.platform=window.zs.laya.platform||{},Laya);