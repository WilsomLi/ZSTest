!function(){function o(s,o){d++,s.as=w,s.at=p,s.rq_c=d,s.ifo=r,s.ak=n.app_key,s.uu=a,s.v=e,s.st=Date.now(),s.ev=o,s.wsr=h,s.ufo=function(e){if(void 0===e||""===e)return"";var t={};for(var n in e)"rawData"!=n&&"errMsg"!=n&&(t[n]=e[n]);return t}(s.ufo),s.ec=l,wx.Queue.push(function(){return new Promise(function(e,n){wx.request({url:"https://"+t+".aldwx.com/d.html",data:s,header:{se:i||"",op:f||"",img:y||""},method:"GET",success:function(){e("")},fail:function(){e("")}})})})}function c(e){var t={};for(var n in e)t[n]=e[n];return t}function u(e){for(var t="",n=0;n<e.length;n++)e[n].length>t.length&&(t=e[n]);return t}wx.Queue=new function(){this.concurrency=5,this.queue=[],this.tasks=[],this.activeCount=0;var e=this;this.push=function(t){this.tasks.push(new Promise(function(n,r){var a=function(){e.activeCount++,t().then(function(e){n(e)}).then(function(){e.next()})};e.activeCount<e.concurrency?a():e.queue.push(a)}))},this.all=function(){return Promise.all(this.tasks)},this.next=function(){e.activeCount--,e.queue.length>0&&e.queue.shift()()}},wx.Queue.all();var e="1.0.0",t="glog",n=require("./ald-game-conf");""===n.app_key&&console.error("请在配置文件中填写您的app_key"),n.app_key=n.app_key.replace(/\s/g,""),wx.request({url:"https://"+t+".aldwx.com/config/app.json",method:"GET",success:function(t){200===t.statusCode&&(t.data.version!=e&&console.warn("您的SDK不是最新版本，请尽快升级！"),t.data.warn&&console.warn(t.data.warn),t.data.error&&console.error(t.data.error))}});var r="",a=function(){var e="";try{e=wx.getStorageSync("aldstat_uuid"),wx.setStorageSync("ald_ifo",!0)}catch(t){e="uuid_getstoragesync"}if(e)r=!1;else{e=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()+e()+e()+e()+e()}(),r=!0;try{wx.setStorageSync("aldstat_uuid",e)}catch(e){wx.setStorageSync("aldstat_uuid","uuid_getstoragesync")}}return e}(),s={},i="",f="",l=0,d="",h=wx.getLaunchOptionsSync(),g=Date.now(),p=""+Date.now()+Math.floor(1e7*Math.random()),w=""+Date.now()+Math.floor(1e7*Math.random()),_=0,v="",y="",S=!0,x=["aldSendEvent","aldOnShareAppMessage","aldShareAppMessage","aldSendSession","aldSendOpenid"];Promise.all([new Promise(function(e,t){wx.getSetting({success:function(t){t.authSetting["scope.userInfo"]?wx.getUserInfo({success:function(t){y=u(t.userInfo.avatarUrl.split("/")),e(t)},fail:function(){e("")}}):e("")},fail:function(){e("")}})}),new Promise(function(e,t){wx.getNetworkType({success:function(t){e(t)},fail:function(){e("")}})}),new Promise(function(e,t){n.getLocation?wx.getLocation({success:function(t){e(t)},fail:function(){e("")}}):wx.getSetting({success:function(t){t.authSetting["scope.userLocation"]?(wx.getLocation({success:function(t){e(t)},fail:function(){e("")}}),e("")):e("")},fail:function(){e("")}})})]).then(function(e){""!==e[2]?(s.lat=e[2].latitude||"",s.lng=e[2].longitude||"",s.spd=e[2].speed||""):(s.lat="",s.lng="",s.spd=""),""!==e[1]?s.nt=e[1].networkType||"":s.nt="";var t=c(s);""!==e[0]&&(t.ufo=e[0],v=e[0]),o(t,"init")}),wx.onShow(function(e){d=0,h=e,_=Date.now(),S||(p=""+Date.now()+Math.floor(1e7*Math.random()),r=!1,wx.setStorageSync("ald_ifo",!1)),S=!1;var t=c(s),n=c(s);t.sm=_-g,e.query.ald_share_src&&e.shareTicket&&"1044"===e.scene?(n.tp="ald_share_click",new Promise(function(e,t){"1044"==h.scene?wx.getShareInfo({shareTicket:h.shareTicket,success:function(t){e(t)},fail:function(){e("")}}):e("")}).then(function(e){n.ct=e,o(n,"event")})):e.query.ald_share_src&&(n.tp="ald_share_click",n.ct="1",o(n,"event")),o(t,"show")}),wx.onHide(function(){var e=c(s);e.dr=Date.now()-_,""===v?wx.getSetting({success:function(t){t.authSetting["scope.userInfo"]?wx.getUserInfo({success:function(t){e.ufo=t,v=t,y=u(t.userInfo.avatarUrl.split("/")),o(e,"hide")}}):o(e,"hide")}}):o(e,"hide")}),wx.onError(function(e){var t=c(s);t.tp="ald_error_message",t.ct=e,l++,o(t,"event")});for(var m={aldSendEvent:function(e,t){var n=c(s);""!==e&&"string"==typeof e&&e.length<=255?(n.tp=e,"string"==typeof t&&t.length<=255?(n.ct=String(t),o(n,"event")):"object"==typeof t?(JSON.stringify(t).length>=255&&console.error("自定义事件参数不能超过255个字符"),n.ct=JSON.stringify(t),o(n,"event")):void 0===t||""===t?o(n,"event"):console.error("事件参数必须为String,Object类型,且参数长度不能超过255个字符")):console.error("事件名称必须为String类型且不能超过255个字符")},aldOnShareAppMessage:function(e){wx.updateShareMenu({withShareTicket:!0,complete:function(){wx.onShareAppMessage(function(){var t=e(),n="",r="";n=void 0!==t.success?t.success:"",r=void 0!==t.fail?t.fail:"";var i;i=void 0!==h.query.ald_share_src?void 0!==t.query?(h.query.ald_share_src.indexOf(a),t.query+"&ald_share_src="+h.query.ald_share_src+","+a):(h.query.ald_share_src.indexOf(a),"ald_share_src="+h.query.ald_share_src+","+a):void 0!==t.query?t.query+"&ald_share_src="+a:"ald_share_src="+a;var u=c(s);return t.query=i,u.ct=t,u.tp="ald_share_chain",o(u,"event"),t.success=function(e){u.tp="ald_share_status",o(u,"event"),""!==n&&n(e)},t.fail=function(e){u.tp="ald_share_fail",o(u,"event"),""!==r&&r(e)},t})}})},aldShareAppMessage:function(e){var t=e,n="",r="";n=void 0!==t.success?t.success:"",r=void 0!==t.fail?t.fail:"";var i;i=void 0!==h.query.ald_share_src?void 0!==t.query?(h.query.ald_share_src.indexOf(a),t.query+"&ald_share_src="+h.query.ald_share_src+","+a):(h.query.ald_share_src.indexOf(a),"ald_share_src="+h.query.ald_share_src+","+a):void 0!==t.query?t.query+"&ald_share_src="+a:"ald_share_src="+a,t.query=i;var u=c(s);u.ct=t,u.tp="ald_share_chain",o(u,"event"),t.success=function(e){u.tp="ald_share_status",o(u,"event"),""!==n&&n(e)},t.fail=function(e){u.tp="ald_share_fail",o(u,"event"),""!==r&&r(e)},wx.updateShareMenu({withShareTicket:!0,complete:function(){wx.shareAppMessage(t)}})},aldSendSession:function(e){if(""!==e&&e){var t=c(s);t.tp="session",t.ct="session",i=e,""===v?wx.getSetting({success:function(e){e.authSetting["scope.userInfo"]?wx.getUserInfo({success:function(e){t.ufo=e,o(t,"event")}}):o(t,"event")}}):(t.ufo=v,""!==v&&(t.gid=""),o(t,"event"))}else console.error("请传入从后台获取的session_key")},aldSendOpenid:function(e){if(""!==e&&e){f=e;var t=c(s);t.tp="openid",t.ct="openid",o(t,"event")}else console.error("openID不能为空")}},q=0;q<x.length;q++)!function(e,t){Object.defineProperty(wx,e,{value:t,writable:!1,enumerable:!0,configurable:!0})}(x[q],m[x[q]]);try{var k=wx.getSystemInfoSync();s.br=k.brand||"",s.md=k.model,s.pr=k.pixelRatio,s.sw=k.screenWidth,s.sh=k.screenHeight,s.ww=k.windowWidth,s.wh=k.windowHeight,s.lang=k.language,s.wv=k.version,s.sv=k.system,s.wvv=k.platform,s.fs=k.fontSizeSetting,s.wsdk=k.SDKVersion,s.bh=k.benchmarkLevel||"",s.bt=k.battery||"",s.wf=k.wifiSignal||"",s.lng="",s.lat="",s.nt="",s.spd="",s.ufo=""}catch(e){}}();